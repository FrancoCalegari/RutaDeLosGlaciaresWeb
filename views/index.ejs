<!DOCTYPE html>
<html lang="es">
	<%- include('partials/head') %>
	<body>
		<%- include('partials/header') %>

		<!-- Fondo dinámico -->
		<div id="dynamic-background">
			<img
				src="<%= background.src %>"
				alt="Fondo dinámico"
				class="background-img"
			/>
			<div class="background-blur"></div>
		</div>

		<div class="hero">
			<img
				src="./assets/img/logo.png"
				alt="Rutas De Los Glaciares Logo"
				class="logo-hero"
			/>
			<h1>Rutas De Los Glaciares</h1>
			<p>Traslados y excursiones privadas en El Calafate y El Chaltén</p>
		</div>

		<div class="productos" id="productos">
			<h2>Nuestros Productos</h2>
			<div class="producto-lista">
				<% const priceFormatter = new Intl.NumberFormat("es-AR", {
				minimumFractionDigits: 0, maximumFractionDigits: 2, }); %> <%
				products.forEach(product => { %> <% const priceValue =
				parseFloat(product.precioProducto) || 0; const discountValue =
				parseFloat(product.descuentoProducto) || 0; const hasDiscount =
				discountValue > 0; const finalPrice = hasDiscount ? priceValue -
				priceValue * (discountValue / 100) : priceValue; %>
				<div class="producto-item">
					<% if (hasDiscount) { %>
					<span class="descuento-badge">-<%= discountValue %>%</span>
					<% } %>
					<img
						src="<%= product.imagenesProducto[0] %>"
						alt="<%= product.nombreProducto %>"
					/>
					<h3><%= product.nombreProducto %></h3>
					<p><%= product.detalleProducto %></p>
					<p><%= product.extrasProducto %></p>
					<span class="precio">
						<% if (hasDiscount) { %>
						<span class="precio-descuento"
							>$<%= priceFormatter.format(finalPrice) %></span
						>
						<span class="precio-original"
							>$<%= priceFormatter.format(priceValue) %></span
						>
						<% } else { %>
						<span class="precio-base"
							>$<%= priceFormatter.format(priceValue) %></span
						>
						<% } %>
					</span>
				</div>
				<% }) %>
			</div>
		</div>

		<!-- Carrusel -->
		<section id="carrusel">
			<h2>Galería de Imágenes</h2>
			<div class="carousel-container">
				<% images.forEach(img => { %>
				<img
					src="<%= img.src %>"
					alt="<%= img.alt %>"
					class="carousel-img"
					onclick="openModal(this)"
				/>
				<% }) %>
			</div>
		</section>

		<!-- Modal -->
		<div id="imageModal" class="modal">
			<span class="close" onclick="closeModal()">&times;</span>
			<div class="modalContainer">
				<div class="modalimagecontainer">
					<img class="modal-content" id="modalImage" />
				</div>

				<div id="caption"></div>
			</div>
		</div>

		<!-- Resumen -->
		<section id="resumen-servicios">
			<h2><%= summary.title %></h2>
			<p><%= summary.description %></p>
		</section>

		<!-- Servicios -->
		<section id="servicios">
			<h2>Servicios principales</h2>
			<% services.forEach(s => { %>
			<article>
				<h3><%= s.title %></h3>
				<% if (s.content) { %>
				<p><%= s.content %></p>
				<% } else if (s.items) { %>
				<ul>
					<% s.items.forEach(item => { %>
					<li><%= item %></li>
					<% }) %>
				</ul>
				<% } %>
			</article>
			<% }) %>
		</section>

		<!-- Ventajas -->
		<section id="ventajas">
			<h2><%= advantages.title %></h2>
			<ul>
				<% advantages.items.forEach(v => { %>
				<li><strong><%= v.strong %>:</strong> <%= v.text %></li>
				<% }) %>
			</ul>
		</section>

		<!-- Costos -->
		<section id="costos">
			<h2><%= costs.title %></h2>
			<ul>
				<% costs.items.forEach(c => { %>
				<li><%= c %></li>
				<% }) %>
			</ul>
		</section>

		<%- include('partials/footer') %>

		<a
			class="whatsapp-float"
			href="https://wa.me/5492617735869"
			target="_blank"
			rel="noopener noreferrer"
			aria-label="Contactar por WhatsApp"
		>
			<i class="fa-brands fa-whatsapp"></i>
		</a>

		<script>
			window.addEventListener("scroll", () => {
				const scrollY = window.scrollY;
				const body = document.body;
				if (scrollY > 150) {
					body.classList.add("scrolled");
				} else {
					body.classList.remove("scrolled");
				}
			});
		</script>

		<script>
			const modal = document.getElementById("imageModal");
			const modalImg = document.getElementById("modalImage");
			const captionText = document.getElementById("caption");
			function openModal(img) {
				modal.style.display = "block";
				modalImg.src = img.src;
				captionText.innerHTML = img.alt;
			}
			function closeModal() {
				modal.style.display = "none";
			}
			window.onclick = function (event) {
				if (event.target == modal) {
					modal.style.display = "none";
				}
			};
		</script>
	</body>
</html>
